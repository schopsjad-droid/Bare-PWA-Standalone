# ๐ ูุดุฑ Cloud Functions - ุฏููู ุฎุทูุฉ ุจุฎุทูุฉ

## โ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. **ุฎุทุฉ Firebase Blaze ููุนูุฉ**
โ๏ธ **ููู ุฌุฏุงู:** Cloud Functions ุชุชุทูุจ ุฎุทุฉ Blaze (ุงูุฏูุน ุญุณุจ ุงูุงุณุชุฎุฏุงู).

**ููุชุญูู:**
1. ุงูุชุญ: https://console.firebase.google.com/project/bare-android-app/usage
2. ุฅุฐุง ูุงูุช ุงูุฎุทุฉ "Spark" (ูุฌุงููุฉ)ุ ุงุถุบุท **Upgrade**
3. ุงุฎุชุฑ **Blaze Plan**
4. ุฃุฏุฎู ุจูุงูุงุช ุงูุฏูุน (ูู ูุชู ุงูุฎุตู ุฅูุง ุจุนุฏ ุชุฌุงูุฒ ุงูุญุฏ ุงููุฌุงูู)

**ุงูุญุฏ ุงููุฌุงูู:**
- 2 ููููู ุงุณุชุฏุนุงุก/ุดูุฑ
- 400,000 GB-second
- 200,000 CPU-second
- **ูุงูู ุฌุฏุงู ููุงุณุชุฎุฏุงู ุงูุนุงุฏู!**

---

### 2. **Node.js ูุซุจุช**
ุชุญูู ูู ุงูุชุซุจูุช:
```bash
node --version
# ูุฌุจ ุฃู ูุธูุฑ: v18.x ุฃู v20.x
```

ุฅุฐุง ูู ููู ูุซุจุชุงู:
- **Windows/Mac:** https://nodejs.org/
- **Linux:**
  ```bash
  curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
  sudo apt-get install -y nodejs
  ```

---

### 3. **Firebase CLI ูุซุจุช**
ุชุญูู ูู ุงูุชุซุจูุช:
```bash
firebase --version
```

ุฅุฐุง ูู ููู ูุซุจุชุงู:
```bash
npm install -g firebase-tools
```

---

## ๐ ุฎุทูุงุช ุงููุดุฑ

### **ุงูุฎุทูุฉ 1: ุชุณุฌูู ุงูุฏุฎูู ุฅูู Firebase**

```bash
firebase login
```

- ุณุชูุชุญ ูุงูุฐุฉ ูุชุตูุญ
- ุณุฌู ุฏุฎูู ุจุญุณุงุจ Google ุงููุฑุชุจุท ุจูุดุฑูุน Firebase
- ุงุถุบุท **Allow**

---

### **ุงูุฎุทูุฉ 2: ุงุณุชูุณุงุฎ ุงููุดุฑูุน (ุฅุฐุง ูู ููู ููุฌูุฏุงู)**

ุฅุฐุง ูุงู ุงููุดุฑูุน ููุฌูุฏุงู ุนูู ุฌูุงุฒูุ ุชุฎุทู ูุฐู ุงูุฎุทูุฉ.

```bash
git clone https://github.com/schopsjad-droid/Bare-PWA-Standalone.git
cd Bare-PWA-Standalone
```

---

### **ุงูุฎุทูุฉ 3: ุชุซุจูุช ุงูููุชุจุงุช**

```bash
cd functions
npm install
cd ..
```

**ููุงุญุธุฉ:** ูุฏ ุชุธูุฑ ุชุญุฐูุฑุงุช (warnings) - ูุฐุง ุทุจูุนูุ ุชุฌุงูููุง.

---

### **ุงูุฎุทูุฉ 4: ูุดุฑ Cloud Functions**

```bash
firebase deploy --only functions --project bare-android-app
```

**ูุงุฐุง ุณูุญุฏุซ:**
1. ูุชู ุฑูุน ุงูููุฏ ุฅูู Firebase
2. ูุชู ุจูุงุก Cloud Functions ุนูู ุงูุณูุฑูุฑ
3. ูุชู ูุดุฑ ุงูู Functions:
   - `cleanupAdImages` (ููุฌูุฏุฉ ูุณุจูุงู)
   - `sendMessageNotification` (ุฌุฏูุฏุฉ)

**ุงูููุช ุงููุชููุน:** 2-5 ุฏูุงุฆู

---

## โ ุงูุชุญูู ูู ุงููุฌุงุญ

### **1. ูู Terminal:**
ูุฌุจ ุฃู ุชุฑู:
```
โ  functions[europe-west1-cleanupAdImages]: Successful update operation.
โ  functions[europe-west1-sendMessageNotification]: Successful create operation.

โ  Deploy complete!
```

---

### **2. ูู Firebase Console:**

ุงูุชุญ:
```
https://console.firebase.google.com/project/bare-android-app/functions
```

ูุฌุจ ุฃู ุชุฑู:
- โ `cleanupAdImages` (europe-west1)
- โ `sendMessageNotification` (europe-west1)

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช

### **ุงูุฎุทูุฉ 1: ุงูุชุญ ุงููููุน**
```
https://bare-android-app.web.app
```

### **ุงูุฎุทูุฉ 2: ุณุฌู ุฏุฎูู**
- ุจุนุฏ 2 ุซุงููุฉุ ุณุชุธูุฑ ุฑุณุงูุฉ ุทูุจ ุงูุฅุฐู
- ุงุถุบุท **Allow**

### **ุงูุฎุทูุฉ 3: ุงูุชุญ ุงููููุน ูู ูุชุตูุญ ุขุฎุฑ**
- ุณุฌู ุฏุฎูู ุจุญุณุงุจ ูุฎุชูู

### **ุงูุฎุทูุฉ 4: ุฃูุดุฆ ูุญุงุฏุซุฉ**
- ุงููุณุชุฎุฏู A: ุฃูุดุฆ ุฅุนูุงู
- ุงููุณุชุฎุฏู B: ุงุถุบุท "ุฑุงุณู ุงูุจุงุฆุน"
- ุงููุณุชุฎุฏู B: ุฃุฑุณู ุฑุณุงูุฉ

### **ุงูุฎุทูุฉ 5: ุชุญูู ูู ุงูุฅุดุนุงุฑ**
- **ุงููุณุชุฎุฏู A ูุฌุจ ุฃู ูุณุชูุจู ุฅุดุนุงุฑ!** ๐

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุฎุทุฃ: "Failed to authenticate"**
**ุงูุณุจุจ:** ูู ุชุณุฌู ุฏุฎูู ุฅูู Firebase CLI

**ุงูุญู:**
```bash
firebase login
```

---

### **ุฎุทุฃ: "Billing account not configured"**
**ุงูุณุจุจ:** ุฎุทุฉ Firebase ููุณุช Blaze

**ุงูุญู:**
1. ุงูุชุญ: https://console.firebase.google.com/project/bare-android-app/usage
2. ุงุถุบุท **Upgrade to Blaze**
3. ุฃุฏุฎู ุจูุงูุงุช ุงูุฏูุน

---

### **ุฎุทุฃ: "Permission denied"**
**ุงูุณุจุจ:** ุญุณุงุจู ููุณ ูุฏูู ุตูุงุญูุงุช ุนูู ุงููุดุฑูุน

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู ุจุงูุญุณุงุจ ุงูุตุญูุญ
2. ุชุญูู ูู ุงูุตูุงุญูุงุช ูู Firebase Console

---

### **ุงูุฅุดุนุงุฑุงุช ูุง ุชุตู**
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**

1. **Cloud Function ูู ุชููุดุฑ:**
   - ุชุญูู ูู Firebase Console โ Functions
   - ูุฌุจ ุฃู ุชุฑู `sendMessageNotification`

2. **VAPID Key ุบูุฑ ุตุญูุญ:**
   - ุชุญูู ูู `src/utils/notifications.ts`
   - ูุฌุจ ุฃู ูุญุชูู ุนูู ุงูููุชุงุญ ุงูุตุญูุญ

3. **FCM Token ูู ููุญูุธ:**
   - ุงูุชุญ Firestore
   - ุงูุชุญ ูุณุชูุฏ ุงููุณุชุฎุฏู
   - ุชุญูู ูู ูุฌูุฏ `fcmTokens`

4. **ุงูุฅุฐู ูุฑููุถ:**
   - ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงููุชุตูุญ
   - Chrome: Settings โ Privacy โ Notifications

---

## ๐ ูุฑุงูุจุฉ Cloud Functions

### **Logs ูู Firebase Console:**
```
https://console.firebase.google.com/project/bare-android-app/functions/logs
```

**ุงุจุญุซ ุนู:**
```
New message in chat abc123
Recipient: xyz789
Sending notification to 2 devices
Notification sent to token: ABC...
```

---

### **Logs ูู Terminal (ูุจุงุดุฑ):**
```bash
firebase functions:log --project bare-android-app
```

---

## ๐ฐ ุงูุชูููุฉ ุงููุชููุนุฉ

### **ุงูุญุฏ ุงููุฌุงูู (ุดูุฑูุงู):**
- 2,000,000 ุงุณุชุฏุนุงุก
- 400,000 GB-second
- 200,000 CPU-second

### **ุชูุฏูุฑ ุงูุงุณุชุฎุฏุงู:**
- ูู ุฑุณุงูุฉ = 1 ุงุณุชุฏุนุงุก
- 1000 ุฑุณุงูุฉ/ููู = 30,000 ุฑุณุงูุฉ/ุดูุฑ
- **ุฃูู ุจูุซูุฑ ูู ุงูุญุฏ ุงููุฌุงูู!**

### **ุงูุชูููุฉ ุจุนุฏ ุชุฌุงูุฒ ุงูุญุฏ:**
- $0.40 ููู ููููู ุงุณุชุฏุนุงุก
- $0.0000025 ููู GB-second
- **ุชูุฑูุจุงู $0 ููุงุณุชุฎุฏุงู ุงูุนุงุฏู**

---

## ๐ ููุงุญุธุงุช ูููุฉ

### **ุงูุฃูุงู:**
- Cloud Functions ุชุนูู ุนูู ุฎูุงุฏู Google - ุขููุฉ
- ูุง ูููู ุงููุตูู ุฅูููุง ูุจุงุดุฑุฉ ูู ุงูุฅูุชุฑูุช
- ุชูุดุบู ููุท ุนูุฏ ุฅูุดุงุก ุฑุณุงูุฉ ุฌุฏูุฏุฉ

### **ุงูุฃุฏุงุก:**
- ุงูุฅุดุนุงุฑุงุช ุชูุฑุณู ููุฑุงู (< 1 ุซุงููุฉ)
- Cloud Functions ุชุจุฏุฃ ุชููุงุฆูุงู ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุญุงุฌุฉ ูุฎุงุฏู ุฏุงุฆู ุงูุชุดุบูู

### **ุงูุตูุงูุฉ:**
- ูุง ุญุงุฌุฉ ูุตูุงูุฉ ุฏูุฑูุฉ
- ุงูุชุญุฏูุซุงุช ุชุชู ุนุจุฑ `firebase deploy`
- Logs ูุชุงุญุฉ ูู Firebase Console

---

## ๐ฏ ุงูุฎูุงุตุฉ

### **ุงูุฃูุงูุฑ ุงููุงููุฉ (ูุณุฎุฉ ุณุฑูุนุฉ):**
```bash
# 1. ุชุณุฌูู ุงูุฏุฎูู
firebase login

# 2. ุงูุงูุชูุงู ูููุดุฑูุน
cd path/to/Bare-PWA-Standalone

# 3. ุชุซุจูุช ุงูููุชุจุงุช
cd functions
npm install
cd ..

# 4. ุงููุดุฑ
firebase deploy --only functions --project bare-android-app
```

---

## โ ุจุนุฏ ุงููุดุฑ ุงููุงุฌุญ

1. โ ุงูุชุญ ุงููููุน ูุณุฌู ุฏุฎูู
2. โ ุงุณูุญ ุจุงูุฅุดุนุงุฑุงุช
3. โ ุฌุฑุจ ุฅุฑุณุงู ุฑุณุงูุฉ
4. โ **ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ!** ๐

---

## ๐ ุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ูุดุงูู:

1. **ุฑุงุฌุน Logs:**
   ```bash
   firebase functions:log --project bare-android-app
   ```

2. **ุชุญูู ูู Firebase Console:**
   ```
   https://console.firebase.google.com/project/bare-android-app/functions
   ```

3. **ุชุญูู ูู Browser Console:**
   - F12 โ Console
   - ุงุจุญุซ ุนู ุฃุฎุทุงุก

---

**ุจุงูุชูููู! ๐**
